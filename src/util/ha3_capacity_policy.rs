use super::capacity_policy::CapacityPolicy;

const CAPACITIES: [usize; 75] = [
    6, 1543, 3079, 6151, 12289, 24593, 49157, 98317, 196613, 393241, 786433, 1572869, 3145739,
    6291469, 12582917, 12582919, 12582929, 12582967, 12582971, 12582991, 12583003, 12583007,
    12583027, 12583031, 12583037, 12583061, 12583063, 12583091, 12583099, 12583121, 12583157,
    12583159, 12583171, 12583177, 12583183, 12583211, 12583217, 12583237, 12583273, 12583297,
    12583327, 12583379, 12583397, 12583409, 12583423, 12583429, 12583463, 12583469, 12583481,
    12583499, 12583511, 12583513, 12583517, 12583523, 12583559, 12583561, 12583573, 12583577,
    12583583, 12583591, 12583601, 12583603, 12583607, 12583609, 12583657, 12583661, 12583693,
    12583699, 12583721, 12583741, 12583759, 12583777, 12583787, 12583789, 12583817,
];

#[derive(Default)]
pub struct Ha3CapacityPolicy;

impl CapacityPolicy for Ha3CapacityPolicy {
    fn next_capacity(&self, current: usize) -> usize {
        match CAPACITIES.binary_search(&current) {
            Ok(i) | Err(i) => CAPACITIES[std::cmp::min(i, CAPACITIES.len() - 1)],
        }
    }
}
